<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
    .hs-linenum {
      color: #B2B2B2; 
      font-style: italic;
    }
    
    .hs-error {
      background-color: #FF8585 ;
    }
    
    .hs-keyglyph {
      color: #007020
    }
    
    .hs-keyword {
      color: #007020;
      // font-weight: bold;
    }
    
    .hs-comment, .hs-comment a {color: green;}
    
    .hs-str, .hs-chr {color: teal;}
    
    .hs-conid { 
      color: #902000;   /* color: #00FFFF; color: #0E84B5; */
      //font-weight: bold;  
    }
    
    .hs-definition { 
      color: #06287E 
      /* font-weight: bold; */ 
    }
    
    .hs-varid, .hs-varop, .hs-layout {
      color: black; 
    }
    
    .hs-num {
      color: #40A070;
    }
    
    .hs-conop {
      color: #902000; 
    }
    
    .hs-cpp {
      color: orange;
    }
    
    .hs-sel  {}
    
    a.annot {
      position:relative; 
      color:#000;
      text-decoration:none; 
      white-space: pre; 
    }
    
    a.annot:hover { 
      z-index:25; 
      background-color: #D8D8D8;
    }
    
    a.annot span.annottext{display: none}
    
    a.annot:hover span.annottext{ 
      
      border-radius: 5px 5px;
      
      -moz-border-radius: 5px; 
      -webkit-border-radius: 5px; 
      
      box-shadow: 5px 5px 5px rgba(0, 0, 0, 0.1); 
      -webkit-box-shadow: 5px 5px rgba(0, 0, 0, 0.1);
      -moz-box-shadow: 5px 5px rgba(0, 0, 0, 0.1); 
    
      white-space:pre;
      display:block;
      position: absolute; 
      left: 1em; top: 2em; 
      z-index: 99;
      margin-left: 5; 
      background: #FFFFAA; 
      border: 3px solid #FFAD33;
      padding: 0.8em 1em;
    }
    
    code {
       /* font-weight: bold; */
       background-color: rgb(250, 250, 250); 
       border: 1px solid rgb(200, 200, 200);
       padding-left: 4px;
       padding-right: 4px;
    }
    
    pre {
      background-color: #f0f0f0;
      border-top: 1px solid #ccc;
      border-bottom: 1px solid #ccc;
      padding: 5px;
      // font-size: 120%;
      // font-family: Bitstream Vera Sans Mono,monospace;
      display: block;
      overflow: visible;
    }
    
    pre>code {
        border: none;
        background: none;
    }
  </style>
  <script>
  
  document.addEventListener("DOMContentLoaded", function(event) {
      document.body.innerHTML = document.body.innerHTML.replace(/ (.*) /g,function(str){return "<span class='hs-error'>"+str.substring(1, str.length - 1)+"</span>"})
  });
  
  </script>
</head>
<body>
<pre><span class=hs-linenum>  1: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Test2</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>abs</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>-- Step 1: Write down the set of CONSTRAINTS with KVars</span>
<span class=hs-linenum>  5: </span>
<span class=hs-linenum>  6: </span><span class='hs-comment'>-- Γ represents the imported environment (Prelude, etc)</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-definition'>abs</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>-- wf: Γ x:κx ⊦ κ1</span>
<span class=hs-linenum> 10: </span><span class='hs-comment'>-- wf: Γ ⊦ x:κx</span>
<span class=hs-linenum> 11: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | false} -&gt; {VV : GHC.Types.Int | false}</span><span class='hs-definition'>abs</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | false}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>b</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Bool | Prop v &lt;=&gt; x1 &lt;= x2}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>in</span>
<span class=hs-linenum> 12: </span>            <a class=annot href="#"><span class=annottext>x1:GHC.Prim.Int# -&gt; {v : GHC.Types.Int | v == (x1 : int)}</span><span class='hs-keyword'>if</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v == b}</span><span class='hs-varid'>b</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x}</span><span class='hs-varid'>x</span></a> <span class='hs-keyword'>else</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 - x2}</span><span class='hs-comment'>-</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 13: </span><span class='hs-comment'>-- wf: Γ;x:κx ⊦ κiflet</span>
<span class=hs-linenum> 14: </span><span class='hs-comment'>-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif</span>
<span class=hs-linenum> 15: </span><span class='hs-comment'>-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif &lt;: κiflet</span>
<span class=hs-linenum> 16: </span><span class='hs-comment'>--   Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};b ⊦ x &lt;: κif</span>
<span class=hs-linenum> 17: </span><span class='hs-comment'>--     Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0} &lt;: Int</span>
<span class=hs-linenum> 18: </span><span class='hs-comment'>--     Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=x} &lt;: Int</span>
<span class=hs-linenum> 19: </span><span class='hs-comment'>--   Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0-x} &lt;: κif</span>
<span class=hs-linenum> 20: </span><span class='hs-comment'>-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κiflet &lt;: κ1</span>
<span class=hs-linenum> 21: </span>
<span class=hs-linenum> 22: </span><span class='hs-definition'>test2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 23: </span><span class='hs-comment'>-- wf: Γ ⊦ n:κn</span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- wf: Γ n:κn ⊦ κ2</span>
<span class=hs-linenum> 25: </span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | false} -&gt; GHC.Types.Int</span><span class='hs-definition'>test2</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | false}</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | false}</span><span class='hs-varid'>a</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | false} -&gt; {v : GHC.Types.Int | false}</span><span class='hs-varid'>abs</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum> 26: </span>            <span class='hs-comment'>-- wf: Γ ⊦ κlet</span>
<span class=hs-linenum> 27: </span>            <span class='hs-comment'>-- Γ ⊦ κlet &lt;: κ2</span>
<span class=hs-linenum> 28: </span>            <span class='hs-comment'>-- Γ ⊦ κn &lt;: κx</span>
<span class=hs-linenum> 29: </span>              <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>b</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == a}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum> 30: </span>            <span class='hs-comment'>-- Γ;a:κ1[x := n] ⊦ κ1 &lt;: Int</span>
<span class=hs-linenum> 31: </span>            <span class='hs-comment'>-- Γ;a:κ1[x := n] ⊦ {v:Int|v=1} &lt;: Int</span>
<span class=hs-linenum> 32: </span>          <span class='hs-keyword'>in</span>
<span class=hs-linenum> 33: </span>              <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:{v : GHC.Types.Int | v /= 0} -&gt; {v : GHC.Types.Int | v == x1 / x2 &amp;&amp; (x1 &gt;= 0 &amp;&amp; x2 &gt;= 0 =&gt; v &gt;= 0) &amp;&amp; (x1 &gt;= 0 &amp;&amp; x2 &gt;= 1 =&gt; v &lt;= x1)}</span><span class='hs-varid'>div</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == b}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum> 34: </span>               <span class='hs-comment'>-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ κn &lt;: Int</span>
<span class=hs-linenum> 35: </span>               <span class='hs-comment'>-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ {v:Int|v=a+1} &lt;: {v:Int|¬(v=0)}</span>
<span class=hs-linenum> 36: </span>             <span class='hs-comment'>-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ Int &lt;: κlet</span>
<span class=hs-linenum> 37: </span>
<span class=hs-linenum> 38: </span><span class='hs-comment'>{-

Constriants:

-- wf: Γ ⊦ x:κx
-- wf: Γ x:κx ⊦ κ1
-- wf: Γ;x:κx ⊦ κiflet
-- wf: Γ ⊦ n:κn
-- wf: Γ n:κn ⊦ κ2
-- wf: Γ ⊦ κlet
-- wf: Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif

-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif &lt;: κiflet
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};b ⊦ x &lt;: κif
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0-x} &lt;: κif
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κiflet &lt;: κ1
-- Γ ⊦ κlet &lt;: κ2
-- Γ ⊦ κn &lt;: κx
-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ Int &lt;: κlet

-- Γ;a:κ1[x := n] ⊦ κ1 &lt;: Int
-- Γ;a:κ1[x := n] ⊦ {v:Int|v=1} &lt;: Int
-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ κn &lt;: Int
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0} &lt;: Int
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=x} &lt;: Int
-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ {v:Int|v=a+1} &lt;: {v:Int|¬(v=0)}

Step 2: Figure out the SOLUTION of the KVars using the given qualifiers

QInst(⋯) = { 0 &lt;= v, 0 &lt;= a, 0 &lt;= n, 0 &lt;= b, 0 &lt;= x }

Inital Solution:

κn      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κx      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }

-- wf: Γ ⊦ x:κx

κn      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }

-- wf: Γ x:κx ⊦ κ1

κn      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }

-- wf: Γ;x:κx ⊦ κiflet

κn      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }

-- wf: Γ ⊦ n:κn

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }

-- wf: Γ n:κn ⊦ κ2

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- wf: Γ ⊦ κlet

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= a /\ 0 &lt;= n /\ 0 &lt;= x /\ 0 &lt;= b }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- wf: Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

Done with the wf constraints!

-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κif &lt;: κiflet

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v }
κif     =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0-x} &lt;: κif

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v }
κif     =  {v:Int | 0 &lt;= v }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x} ⊦ κiflet &lt;: κ1

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int | 0 &lt;= v }
κif     =  {v:Int | 0 &lt;= v }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- Γ ⊦ κlet &lt;: κ2

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int}
κif     =  {v:Int | 0 &lt;= v }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- Γ ⊦ κn &lt;: κx

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int}
κif     =  {v:Int | 0 &lt;= v }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ Int &lt;: κlet

κn      =  {v:Int | 0 &lt;= v }
κx      =  {v:Int | 0 &lt;= v }
κ1      =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κlet    =  {v:Int}
κif     =  {v:Int | 0 &lt;= v }
κiflet  =  {v:Int | 0 &lt;= v /\ 0 &lt;= x }
κ2      =  {v:Int | 0 &lt;= v /\ 0 &lt;= n }

We don't have to make any more passes with these constraints, because
all the constraints with a kvar on the rhs is satisfied.

-- Γ;a:κ1[x := n] ⊦ κ1 &lt;: Int ✓
-- Γ;a:κ1[x := n] ⊦ {v:Int|v=1} &lt;: Int ✓
-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ κn &lt;: Int ✓
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=0} &lt;: Int ✓
-- Γ;x:κx;b:{Prop v &lt;=&gt; 0&lt;=x};¬b ⊦ {v:Int|v=x} &lt;: Int ✓
-- Γ;a:κ1[x := n];b:{v:Int|v=a+1} ⊦ {v:Int|v=a+1} &lt;: {v:Int|¬(v=0)} ✓

-}</span>
</pre>
</body>
</html>
